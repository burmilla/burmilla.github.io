<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Google Compute Engine (GCE) #   Note: Due to the maximum transmission unit (MTU) of 1460 bytes on GCE, you will need to configure your network interfaces and both the Docker and System Docker to use a MTU of 1460 bytes or you will encounter weird networking related errors.
 Adding the BurmillaOS Image into GCE #  BurmillaOS is available as an image in GCE, and can be easily run in Google Compute Engine (GCE)."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Google Compute Engine (GCE)"><meta property="og:description" content="Google Compute Engine (GCE) #   Note: Due to the maximum transmission unit (MTU) of 1460 bytes on GCE, you will need to configure your network interfaces and both the Docker and System Docker to use a MTU of 1460 bytes or you will encounter weird networking related errors.
 Adding the BurmillaOS Image into GCE #  BurmillaOS is available as an image in GCE, and can be easily run in Google Compute Engine (GCE)."><meta property="og:type" content="article"><meta property="og:url" content="https://burmillaos.org/docs/installation/cloud/gce/"><meta property="article:modified_time" content="2024-11-03T00:21:50+03:00"><title>Google Compute Engine (GCE) | BurmillaOS</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.6cd8553a6854f4812343f0f0c8baca31271e686434f381fbe3c7226f66639176.css integrity="sha256-bNhVOmhU9IEjQ/DwyLrKMSceaGQ084H748cib2ZjkXY="><script defer src=/en.search.min.5b67b5953e3b2a171b6b51a22a8ef1216b6eae9a8f77e6e93869f90463a51473.js integrity="sha256-W2e1lT47Khcba1GiKo7xIWturpqPd+bpOGn5BGOlFHM="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>BurmillaOS</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/docs/quick-start-guide/>Quick Start Guide</a></li><li><a href=/docs/installation/ class=collapsed>Installation</a><ul><li><a href=/docs/installation/upgrading/>Upgrading</a></li><li><a href=/docs/installation/boot-process/ class=collapsed>Boot Process</a></li><li><a href=/docs/installation/cloud/ class=collapsed>Cloud</a><ul><li><a href=/docs/installation/cloud/aws-ec2/>Amazon EC2</a></li><li><a href=/docs/installation/cloud/amazon-ecs/>Amazon ECS</a></li><li><a href=/docs/installation/cloud/aliyun/>Aliyun</a></li><li><a href=/docs/installation/cloud/azure/>Azure</a></li><li><a href=/docs/installation/cloud/digital-ocean/>Digital Ocean</a></li><li><a href=/docs/installation/cloud/gce/ class=active>Google Compute Engine (GCE)</a></li><li><a href=/docs/installation/cloud/openstack/>OpenStack</a></li><li><a href=/docs/installation/cloud/vmware-esxi/>VMware ESXi</a></li></ul></li><li><a href=/docs/installation/custom-builds/ class=collapsed>Custom Builds</a></li><li><a href=/docs/installation/server/ class=collapsed>Server</a></li><li><a href=/docs/installation/workstation/ class=collapsed>Workstation</a></li></ul></li><li><a href=/docs/configuration/ class=collapsed>Configuration</a></li><li><a href=/docs/networking/ class=collapsed>Networking</a></li><li><a href=/docs/storage/ class=collapsed>Storage</a></li><li><a href=/docs/system-services/ class=collapsed>System Services</a></li><li><a href=/docs/additional-resources/ class=collapsed>Aditional Resources</a></li><li><a href=/docs/faqs/>FAQs</a></li><li><a href=/docs/releases/>Releases</a></li><li><a href=/docs/reference/>Reference</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Google Compute Engine (GCE)</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#adding-the-burmillaos-image-into-gce>Adding the BurmillaOS Image into GCE</a></li><li><a href=#launching-burmillaos-using-gcloud-compute>Launching BurmillaOS using <code>gcloud compute</code></a></li><li><a href=#using-a-cloud-config-file-with-gce>Using a Cloud Config File with GCE</a><ul><li><a href=#adding-your-cloud-config-to-existing-instance>Adding your Cloud Config to Existing Instance</a></li><li><a href=#reviewing-your-cloud-config>Reviewing your Cloud Config</a></li><li><a href=#removing-your-cloud-config>Removing your Cloud Config</a></li><li><a href=#resetting-your-instance>Resetting your Instance</a></li></ul></li><li><a href=#launching-burmillaos-using-the-google-console>Launching BurmillaOS using the Google Console</a><ul><li><a href=#adding-ssh-keys>Adding SSH keys</a></li></ul></li><li><a href=#logging-into-burmillaos>Logging into BurmillaOS</a></li></ul></nav></aside></header><article class=markdown><h1 id=google-compute-engine-gce>Google Compute Engine (GCE)
<a class=anchor href=#google-compute-engine-gce>#</a></h1><blockquote><p><strong>Note:</strong> Due to the maximum transmission unit (MTU) of
<a href=https://cloud.google.com/compute/docs/troubleshooting#packetfragmentation>1460 bytes on GCE</a>, you will need to configure your
<a href=/docs/networking/interfaces>network interfaces</a> and both the
<a href=/docs/configuration/docker/>Docker and System Docker</a> to use a MTU of 1460 bytes or you will encounter weird networking related errors.</p></blockquote><h2 id=adding-the-burmillaos-image-into-gce>Adding the BurmillaOS Image into GCE
<a class=anchor href=#adding-the-burmillaos-image-into-gce>#</a></h2><p>BurmillaOS is available as an image in GCE, and can be easily run in Google Compute Engine (GCE). Letâ€™s walk through how to upload GCE image.</p><ol><li>Download the most recent BurmillaOS image. The image can be found in the
<a href=https://github.com/burmilla/os/releases>release artifacts</a>. It is a <code>.tar.gz</code> file.</li><li>Follow Google&rsquo;s instructions on how to
<a href=https://cloud.google.com/compute/docs/tutorials/building-images#publishingimage>upload the image</a>. The image must be uploaded into a Google Cloud Storage bucket before it can be added to a project.</li><li>Follow Google&rsquo;s instructions on how to
<a href=https://cloud.google.com/compute/docs/images/import-existing-image#use_saved_image>import a RAW image</a>.</li><li>Once the image is added to your Google Compute Engine, we can start creating new instances!</li></ol><h2 id=launching-burmillaos-using-gcloud-compute>Launching BurmillaOS using <code>gcloud compute</code>
<a class=anchor href=#launching-burmillaos-using-gcloud-compute>#</a></h2><p>After the image is uploaded, we can use the <code>gcloud compute</code>
<a href=https://cloud.google.com/compute/docs/gcloud-compute/>command-line tool</a> to start a new instance. It automatically merges the SSH keys from the project and adds the keys to the <strong>rancher</strong> user. If you don&rsquo;t have any project level SSH keys, go to the <em>Adding SSH Keys</em> section to learn more about adding SSH keys.</p><p>Since the image is private, we need to follow Google&rsquo;s
<a href=https://cloud.google.com/compute/docs/creating-custom-image#start_an_instance_from_a_custom_image>instructions</a>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ gcloud compute instances create --project &lt;PROJECT_ID&gt; --zone &lt;ZONE_TO_CREATE_INSTANCE&gt; &lt;INSTANCE_NAME&gt; --image &lt;PRIVATE_IMAGE_NAME&gt;
</code></pre></div><h2 id=using-a-cloud-config-file-with-gce>Using a Cloud Config File with GCE
<a class=anchor href=#using-a-cloud-config-file-with-gce>#</a></h2><p>If you want to pass in your own cloud config file that will be processed by
<a href=/docs/configuration/#cloud-config>cloud init</a>, you can pass it as metadata upon creation of the instance during the <code>gcloud compute</code> command. The file will need to be stored locally before running the command. The key of the metadata will be <code>user-data</code> and the value is the location of the file. If any SSH keys are added in the cloud config file, it will also be added to the <strong>rancher</strong> user.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ gcloud compute instances create --project &lt;PROJECT_ID&gt; --zone &lt;ZONE_TO_CREATE_INSTANCE&gt; &lt;INSTANCE_NAME&gt; --image &lt;PRIVATE_IMAGE_NAME&gt; --metadata-from-file user-data<span style=color:#f92672>=</span>/Directory/of/Cloud_Config.yml
</code></pre></div><h3 id=adding-your-cloud-config-to-existing-instance>Adding your Cloud Config to Existing Instance
<a class=anchor href=#adding-your-cloud-config-to-existing-instance>#</a></h3><p>If you have already created the instance, you can still add the cloud config file after the instance is created. You will just need to reset the machine after you&rsquo;ve added the metadata.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ gcloud compute instances add-metadata &lt;INSTANCE_NAME&gt; --metadata-from-file user-data<span style=color:#f92672>=</span>/Directory/of/File --project &lt;PROJECT_ID&gt; --zone &lt;ZONE_OF_INSTANCE&gt;
Updated <span style=color:#f92672>[</span>https://www.googleapis.com/compute/v1/projects/PROJECT_ID/zones/ZONE_OF_INSTANCE/instances/INSTANCE_NAME<span style=color:#f92672>]</span>.
$ gcloud compute instances reset &lt;INSTANCE_NAME&gt; --project &lt;PROJECT_ID&gt; --zone &lt;ZONE_OF_INSTANCE&gt;
Updated <span style=color:#f92672>[</span>https://www.googleapis.com/compute/v1/projects/PROJECT_ID/zones/ZONE_OF_INSTANCE/instances/INSTANCE_NAME<span style=color:#f92672>]</span>.
</code></pre></div><h3 id=reviewing-your-cloud-config>Reviewing your Cloud Config
<a class=anchor href=#reviewing-your-cloud-config>#</a></h3><p>If you want to review the cloud config file for your instance, review the <strong>metadata</strong> section:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ gcloud compute instances describe &lt;INSTANCE_NAME&gt; --project &lt;PROJECT_ID&gt; --zone &lt;ZONE_OF_INSTANCE&gt;
</code></pre></div><h3 id=removing-your-cloud-config>Removing your Cloud Config
<a class=anchor href=#removing-your-cloud-config>#</a></h3><p>If you want to remove your cloud config file, use the following command to remove the metadata.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ gcloud compute instances remove-metadata &lt;INSTANCE_NAME&gt; --project &lt;PROJECT_ID&gt; --zone &lt;ZONE_OF_INSTANCE&gt; --keys user-data
Updated <span style=color:#f92672>[</span>https://www.googleapis.com/compute/v1/projects/PROJECT_ID/zones/ZONE_OF_INSTANCE/instances/INSTANCE_NAME<span style=color:#f92672>]</span>.
</code></pre></div><h3 id=resetting-your-instance>Resetting your Instance
<a class=anchor href=#resetting-your-instance>#</a></h3><p>After any changes to the cloud config file, you&rsquo;ll need to reset the machine. You can reset either using the console or using this command:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>$ gcloud compute instances reset &lt;INSTANCE_NAME&gt; --project &lt;PROJECT_ID&gt; --zone &lt;ZONE_OF_INSTANCE&gt;
Updated <span style=color:#f92672>[</span>https://www.googleapis.com/compute/v1/projects/PROJECT_ID/zones/ZONE_OF_INSTANCE/instances/INSTANCE_NAME<span style=color:#f92672>]</span>.
</code></pre></div><h2 id=launching-burmillaos-using-the-google-console>Launching BurmillaOS using the Google Console
<a class=anchor href=#launching-burmillaos-using-the-google-console>#</a></h2><p>After the image is uploaded, it&rsquo;s easy to use the console to create new instances. You will <strong>not</strong> be able to upload your own cloud config file when creating instances through the console. You can add it after the instance is created using <code>gcloud compute</code> commands and resetting the instance.</p><ol><li>Make sure you are in the project that the image was created in.
<img src=https://raw.githubusercontent.com/burmilla/rancher.github.io/master/img/BurmillaOS_gce4.png alt="BurmillaOS on GCE 4"></li><li>In the navigation bar, click on the <strong>VM instances</strong>, which is located at Compute -> Compute Engine -> Metadata. Click on <strong>Create instance</strong>.
<img src=https://raw.githubusercontent.com/burmilla/rancher.github.io/master/img/BurmillaOS_gce5.png alt="BurmillaOS on GCE 5"></li><li>Fill out the information for your instance. In the <strong>Image</strong> dropdown, your private image will be listed among the public images provided by Google. Select the private image for BurmillaOS. Click <strong>Create</strong>.
<img src=https://raw.githubusercontent.com/burmilla/rancher.github.io/master/img/BurmillaOS_gce6.png alt="BurmillaOS on GCE 6"></li><li>Your instance is being created and will be up and running shortly!</li></ol><h3 id=adding-ssh-keys>Adding SSH keys
<a class=anchor href=#adding-ssh-keys>#</a></h3><p>In order to SSH into the GCE instance, you will need to have SSH keys set up in either the project instance, add them to the instance after the instance is created, or add them using the <code>gcloud compute</code> commands to add meta-data to an instance.</p><p><strong>Option 1: Project Level SSH Keys</strong></p><p>In your project, click on <strong>Metadata</strong>, which is located within Compute -> Compute Engine -> Metadata. Click on <strong>SSH Keys</strong>.</p><p><img src=https://raw.githubusercontent.com/burmilla/rancher.github.io/master/img/BurmillaOS_gce7.png alt="BurmillaOS on GCE 7"></p><p>Add the SSH keys that you want to have access to any instances within your project.</p><p>Note: If you do this after any BurmillaOS instance is created, you will need to reset the instance so that the SSH keys are added to the <strong>rancher</strong> user.</p><p><strong>Option 2: Instance Level SSH Keys</strong></p><p>After your instance is created, click on the instance name. Scroll down to the <strong>SSH Keys</strong> section and click on <strong>Add SSH key</strong>. This key will only be applicable to the instance.</p><p><img src=https://raw.githubusercontent.com/burmilla/rancher.github.io/master/img/BurmillaOS_gce8.png alt="BurmillaOS on GCE 8"></p><p>After the SSH keys have been added, you&rsquo;ll need to reset the machine, by clicking <strong>Reset</strong>.</p><p><img src=https://raw.githubusercontent.com/burmilla/rancher.github.io/master/img/BurmillaOS_gce9.png alt="BurmillaOS on GCE 9"></p><p>After a little bit, you will be able to SSH into the box using the <strong>rancher</strong> user.</p><p><strong>Option 3: Using the Cloud Config file</strong></p><p>You can add SSH keys by adding them into the cloud config file. Follow the directions above that walk through how to pass the cloud config file to an instance.</p><p>Example of cloud config file that has only SSH keys:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#75715e>#cloud-config</span>

<span style=color:#f92672>ssh_authorized_keys</span>:
  - <span style=color:#ae81ff>ssh-rsa AAA... user@host</span>
</code></pre></div><h2 id=logging-into-burmillaos>Logging into BurmillaOS
<a class=anchor href=#logging-into-burmillaos>#</a></h2><hr><p>Remember, the SSH keys are passed to the <strong>rancher</strong> user. The SSH keys can be passed from the project level, the instance level or through the cloud config file. If you add any of these SSH keys after the instance has been created, the instance will need to be reset before the SSH keys are passed through.</p><pre><code>$ gcloud compute ssh rancher@&lt;INSTANCE_NAME&gt; --project &lt;PROJECT_ID&gt; --zone &lt;ZONE_OF_INSTANCE&gt;
</code></pre><p>If you have issues logging into BurmillaOS, try using this command to help debug the instance.</p><pre><code>$ gcloud compute instances get-serial-port-output &lt;INSTANCE_NAME&gt; --zone &lt;ZONE_OF_INSTANCE&gt; --project &lt;PROJECT_ID&gt;
</code></pre></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/burmilla/burmilla.github.io/commit/d1f8103458f8d8797699dad433c52d714e54f731 title="Last modified by Basil Peace | November 2, 2024" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>November 2, 2024</span></a></div></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#adding-the-burmillaos-image-into-gce>Adding the BurmillaOS Image into GCE</a></li><li><a href=#launching-burmillaos-using-gcloud-compute>Launching BurmillaOS using <code>gcloud compute</code></a></li><li><a href=#using-a-cloud-config-file-with-gce>Using a Cloud Config File with GCE</a><ul><li><a href=#adding-your-cloud-config-to-existing-instance>Adding your Cloud Config to Existing Instance</a></li><li><a href=#reviewing-your-cloud-config>Reviewing your Cloud Config</a></li><li><a href=#removing-your-cloud-config>Removing your Cloud Config</a></li><li><a href=#resetting-your-instance>Resetting your Instance</a></li></ul></li><li><a href=#launching-burmillaos-using-the-google-console>Launching BurmillaOS using the Google Console</a><ul><li><a href=#adding-ssh-keys>Adding SSH keys</a></li></ul></li><li><a href=#logging-into-burmillaos>Logging into BurmillaOS</a></li></ul></nav></aside></main></body></html>