<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="iPXE #  #!ipxe # Boot a persistent BurmillaOS to RAM # Location of Kernel/Initrd images set base-url <url> kernel ${base-url}/vmlinuz rancher.state.dev=LABEL=RANCHER_STATE rancher.state.autoformat=[/dev/sda] rancher.state.wait rancher.cloud_init.datasources=[url:http://example.com/cloud-config] initrd ${base-url}/initrd boot If you want to autoformat the disk when booting by iPXE, you should add the rancher.state.autoformat part to kernel cmdline. However, this does not install the bootloader to disk, so you cannot upgrade BurmillaOS.
If you don&rsquo;t add rancher.state.autoformat, BurmillaOS will run completely in memory, you can execute ros install to install to disk."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="iPXE"><meta property="og:description" content="iPXE #  #!ipxe # Boot a persistent BurmillaOS to RAM # Location of Kernel/Initrd images set base-url <url> kernel ${base-url}/vmlinuz rancher.state.dev=LABEL=RANCHER_STATE rancher.state.autoformat=[/dev/sda] rancher.state.wait rancher.cloud_init.datasources=[url:http://example.com/cloud-config] initrd ${base-url}/initrd boot If you want to autoformat the disk when booting by iPXE, you should add the rancher.state.autoformat part to kernel cmdline. However, this does not install the bootloader to disk, so you cannot upgrade BurmillaOS.
If you don&rsquo;t add rancher.state.autoformat, BurmillaOS will run completely in memory, you can execute ros install to install to disk."><meta property="og:type" content="article"><meta property="og:url" content="https://burmillaos.org/docs/installation/server/pxe/"><meta property="article:modified_time" content="2024-11-03T00:21:50+03:00"><title>iPXE | BurmillaOS</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.6cd8553a6854f4812343f0f0c8baca31271e686434f381fbe3c7226f66639176.css integrity="sha256-bNhVOmhU9IEjQ/DwyLrKMSceaGQ084H748cib2ZjkXY="><script defer src=/en.search.min.5b67b5953e3b2a171b6b51a22a8ef1216b6eae9a8f77e6e93869f90463a51473.js integrity="sha256-W2e1lT47Khcba1GiKo7xIWturpqPd+bpOGn5BGOlFHM="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>BurmillaOS</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/docs/quick-start-guide/>Quick Start Guide</a></li><li><a href=/docs/installation/ class=collapsed>Installation</a><ul><li><a href=/docs/installation/upgrading/>Upgrading</a></li><li><a href=/docs/installation/boot-process/ class=collapsed>Boot Process</a></li><li><a href=/docs/installation/cloud/ class=collapsed>Cloud</a></li><li><a href=/docs/installation/custom-builds/ class=collapsed>Custom Builds</a></li><li><a href=/docs/installation/server/ class=collapsed>Server</a><ul><li><a href=/docs/installation/server/install-to-disk/>Install to Disk</a></li><li><a href=/docs/installation/server/raspberry-pi/>Raspberry Pi</a></li><li><a href=/docs/installation/server/pxe/ class=active>iPXE</a></li></ul></li><li><a href=/docs/installation/workstation/ class=collapsed>Workstation</a></li></ul></li><li><a href=/docs/configuration/ class=collapsed>Configuration</a></li><li><a href=/docs/networking/ class=collapsed>Networking</a></li><li><a href=/docs/storage/ class=collapsed>Storage</a></li><li><a href=/docs/system-services/ class=collapsed>System Services</a></li><li><a href=/docs/additional-resources/ class=collapsed>Aditional Resources</a></li><li><a href=/docs/faqs/>FAQs</a></li><li><a href=/docs/releases/>Releases</a></li><li><a href=/docs/reference/>Reference</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>iPXE</strong>
<label for=toc-control></label></div></header><article class=markdown><h1 id=ipxe>iPXE
<a class=anchor href=#ipxe>#</a></h1><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e>#!ipxe
</span><span style=color:#75715e></span><span style=color:#75715e># Boot a persistent BurmillaOS to RAM</span>

<span style=color:#75715e># Location of Kernel/Initrd images</span>
set base-url &lt;url&gt;

kernel <span style=color:#e6db74>${</span>base-url<span style=color:#e6db74>}</span>/vmlinuz rancher.state.dev<span style=color:#f92672>=</span>LABEL<span style=color:#f92672>=</span>RANCHER_STATE rancher.state.autoformat<span style=color:#f92672>=[</span>/dev/sda<span style=color:#f92672>]</span> rancher.state.wait rancher.cloud_init.datasources<span style=color:#f92672>=[</span>url:http://example.com/cloud-config<span style=color:#f92672>]</span>
initrd <span style=color:#e6db74>${</span>base-url<span style=color:#e6db74>}</span>/initrd
boot
</code></pre></div><p>If you want to autoformat the disk when booting by iPXE, you should add the <code>rancher.state.autoformat</code> part to kernel cmdline. However, this does not install the bootloader to disk, so you cannot upgrade BurmillaOS.</p><p>If you don&rsquo;t add <code>rancher.state.autoformat</code>, BurmillaOS will run completely in memory, you can execute <code>ros install</code> to install to disk.</p><h2 id=hiding-sensitive-kernel-commandline-parameters>Hiding sensitive kernel commandline parameters
<a class=anchor href=#hiding-sensitive-kernel-commandline-parameters>#</a></h2><p><em>Available as of RancherOS v0.9</em></p><p>Secrets can be put on the <code>kernel</code> parameters line afer a <code>--</code> double dash, and they will be not be shown in any <code>/proc/cmdline</code>. These parameters
will be passed to the BurmillaOS init process and stored in the <code>root</code> accessible <code>/var/lib/rancher/conf/cloud-init.d/init.yml</code> file, and are available to the root user from the <code>ros config</code> commands.</p><p>For example, the <code>kernel</code> line above could be written as:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kernel <span style=color:#e6db74>${</span>base-url<span style=color:#e6db74>}</span>/vmlinuz rancher.state.dev<span style=color:#f92672>=</span>LABEL<span style=color:#f92672>=</span>RANCHER_STATE rancher.state.autoformat<span style=color:#f92672>=[</span>/dev/sda<span style=color:#f92672>]</span> -- rancher.cloud_init.datasources<span style=color:#f92672>=[</span>url:http://example.com/cloud-config<span style=color:#f92672>]</span>
</code></pre></div><p>The hidden part of the command line can be accessed with either <code>sudo ros config get rancher.environment.EXTRA_CMDLINE</code>, or by using a service file&rsquo;s environment array.</p><p>An example service.yml file:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>test</span>:
  <span style=color:#f92672>image</span>: <span style=color:#ae81ff>alpine</span>
  <span style=color:#f92672>command</span>: <span style=color:#ae81ff>echo &#34;tell me a secret ${EXTRA_CMDLINE}&#34;</span>
  <span style=color:#f92672>labels</span>:
    <span style=color:#f92672>io.rancher.os.scope</span>: <span style=color:#ae81ff>system</span>
  <span style=color:#f92672>environment</span>:
  - <span style=color:#ae81ff>EXTRA_CMDLINE</span>
</code></pre></div><p>When this service is run, the <code>EXTRA_CMDLINE</code> will be set.</p><h3 id=cloud-init-datasources>cloud-init Datasources
<a class=anchor href=#cloud-init-datasources>#</a></h3><p>Valid cloud-init datasources for BurmillaOS.</p><table><thead><tr><th>type</th><th>default</th></tr></thead><tbody><tr><td>ec2</td><td>Default metadata address</td></tr><tr><td>digitalocean</td><td>Default metadata address</td></tr><tr><td>packet</td><td>Default metadata address</td></tr><tr><td>cloudstack</td><td>Default metadata address</td></tr><tr><td>aliyun</td><td>Default metadata address</td></tr><tr><td>gce</td><td>Default metadata address</td></tr><tr><td>file</td><td>Path</td></tr><tr><td>cmdline</td><td>Kernel command line: <code>cloud-config-url=http://link/user_data</code></td></tr><tr><td>configdrive</td><td>/media/config-2</td></tr><tr><td>url</td><td>URL address</td></tr><tr><td>vmware</td><td>Set <code>guestinfo</code> cloud-init or interface data as per
<a href=/docs/installation/cloud/vmware-esxi/>VMware ESXi</a></td></tr><tr><td>*</td><td>This will add [&ldquo;configdrive&rdquo;, &ldquo;vmware&rdquo;, &ldquo;ec2&rdquo;, &ldquo;digitalocean&rdquo;, &ldquo;packet&rdquo;, &ldquo;gce&rdquo;] into the list of datasources to try</td></tr></tbody></table><p>The vmware datasource was added as of v1.1.</p><h3 id=cloud-config>Cloud-Config
<a class=anchor href=#cloud-config>#</a></h3><p>When booting via iPXE, BurmillaOS can be configured using a
<a href=/docs/configuration/base/#cloud-config>cloud-config file</a>.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/burmilla/burmilla.github.io/commit/d1f8103458f8d8797699dad433c52d714e54f731 title="Last modified by Basil Peace | November 2, 2024" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>November 2, 2024</span></a></div></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>